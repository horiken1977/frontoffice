<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>テスト仕様書 - フロントオフィス生産性向上アプリ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="progress-sync.js"></script>
    <style>
        .test-case {
            transition: all 0.2s ease-in-out;
        }
        .test-case:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .status-passed { background-color: #dcfce7; border-color: #16a34a; }
        .status-failed { background-color: #fecaca; border-color: #dc2626; }
        .status-pending { background-color: #fef3c7; border-color: #d97706; }
        .status-skipped { background-color: #f3f4f6; border-color: #6b7280; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- ナビゲーション -->
    <nav class="bg-white shadow-sm border-b">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <h1 class="text-xl font-bold text-gray-800">フロントオフィス生産性向上アプリ</h1>
                <div class="space-x-4">
                    <a href="index.html" class="text-blue-600 hover:text-blue-800 font-medium">進捗ダッシュボード</a>
                    <a href="plan.html" class="text-blue-600 hover:text-blue-800 font-medium">開発計画書</a>
                    <a href="test-specification.html" class="text-gray-800 font-medium border-b-2 border-blue-600">テスト仕様書</a>
                    <a href="chat.html" class="text-blue-600 hover:text-blue-800 font-medium">チャット入力</a>
                    <a href="data-search.html" class="text-blue-600 hover:text-blue-800 font-medium">社内データ検索</a>
                    <a href="feedback-dashboard.html" class="text-blue-600 hover:text-blue-800 font-medium">フィードバック</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-8">
        <!-- ヘッダー -->
        <header class="mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">テスト仕様書</h1>
            <p class="text-xl text-gray-600 mb-4">フロントオフィス生産性向上アプリケーション</p>
            <div class="flex items-center space-x-4">
                <span id="test-phase-badge" class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">Phase 1: ワークフロー統合</span>
                <span class="text-gray-500 text-sm">バージョン: v2.1</span>
                <span class="text-gray-500 text-sm">最終更新: 2025-01-07</span>
            </div>
        </header>

        <!-- テスト概要 -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">テスト概要</h2>
            <div class="grid md:grid-cols-4 gap-4">
                <div class="text-center">
                    <div class="text-3xl font-bold text-green-600" id="passed-count">8</div>
                    <div class="text-sm text-gray-600">成功</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-red-600" id="failed-count">0</div>
                    <div class="text-sm text-gray-600">失敗</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-yellow-600" id="pending-count">2</div>
                    <div class="text-sm text-gray-600">保留</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-blue-600" id="coverage">80%</div>
                    <div class="text-sm text-gray-600">カバレッジ</div>
                </div>
            </div>
        </div>

        <!-- Phase 0テストケース -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Phase 0: ゼロコストMVP テストケース</h2>
            <div class="space-y-4">
                <div class="test-case p-4 border-l-4 rounded-lg status-passed">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold text-green-800">TC001: Dify API統合テスト</h3>
                            <p class="text-sm text-green-600 mt-1">Google Gemini Flash APIとの接続確認</p>
                        </div>
                        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">✅ PASSED</span>
                    </div>
                    <div class="mt-3 text-sm text-gray-600">
                        <p><strong>手順:</strong> チャット画面でメッセージ送信</p>
                        <p><strong>期待値:</strong> AI応答が正常に表示される</p>
                        <p><strong>結果:</strong> ✅ 正常に動作確認済み</p>
                    </div>
                </div>

                <div class="test-case p-4 border-l-4 rounded-lg status-passed">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold text-green-800">TC002: 日本語入力テスト</h3>
                            <p class="text-sm text-green-600 mt-1">compositionstart/end対応の誤送信防止</p>
                        </div>
                        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">✅ PASSED</span>
                    </div>
                    <div class="mt-3 text-sm text-gray-600">
                        <p><strong>手順:</strong> 日本語変換中にEnterキー押下</p>
                        <p><strong>期待値:</strong> 変換中は送信されない</p>
                        <p><strong>結果:</strong> ✅ 期待通りの動作を確認</p>
                    </div>
                </div>

                <div class="test-case p-4 border-l-4 rounded-lg status-passed">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold text-green-800">TC003: 長文対応テスト</h3>
                            <p class="text-sm text-green-600 mt-1">5000文字までの入力対応</p>
                        </div>
                        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">✅ PASSED</span>
                    </div>
                    <div class="mt-3 text-sm text-gray-600">
                        <p><strong>手順:</strong> 5000文字のテキストを入力</p>
                        <p><strong>期待値:</strong> 正常に送信・応答される</p>
                        <p><strong>結果:</strong> ✅ 大容量テキスト処理確認済み</p>
                    </div>
                </div>

                <div class="test-case p-4 border-l-4 rounded-lg status-passed">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold text-green-800">TC004: 下書き保存テスト</h3>
                            <p class="text-sm text-green-600 mt-1">自動保存・手動保存機能</p>
                        </div>
                        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">✅ PASSED</span>
                    </div>
                    <div class="mt-3 text-sm text-gray-600">
                        <p><strong>手順:</strong> 下書き保存ボタンクリック</p>
                        <p><strong>期待値:</strong> 入力内容がlocalStorageに保存される</p>
                        <p><strong>結果:</strong> ✅ 保存・読み込み機能確認済み</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 1テストケース -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Phase 1: ワークフロー統合 テストケース</h2>
            <div class="space-y-4">
                <div class="test-case p-4 border-l-4 rounded-lg status-passed">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold text-green-800">TC101: Knowledge Base検索テスト</h3>
                            <p class="text-sm text-green-600 mt-1">Dify Knowledge Baseとの統合確認</p>
                        </div>
                        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">✅ PASSED</span>
                    </div>
                    <div class="mt-3 text-sm text-gray-600">
                        <p><strong>手順:</strong> 社内データ検索画面で検索実行</p>
                        <p><strong>期待値:</strong> Knowledge BaseからAI回答生成</p>
                        <p><strong>結果:</strong> ✅ 統合検索システム動作確認済み</p>
                    </div>
                </div>

                <div class="test-case p-4 border-l-4 rounded-lg status-passed">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold text-green-800">TC102: チャット・データ統合テスト</h3>
                            <p class="text-sm text-green-600 mt-1">チャットUIでの社内データ検索</p>
                        </div>
                        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">✅ PASSED</span>
                    </div>
                    <div class="mt-3 text-sm text-gray-600">
                        <p><strong>手順:</strong> チャット画面で社内データに関する質問</p>
                        <p><strong>期待値:</strong> Knowledge Base検索結果とAI分析の統合表示</p>
                        <p><strong>結果:</strong> ✅ シームレス統合確認済み</p>
                    </div>
                </div>

                <div class="test-case p-4 border-l-4 rounded-lg status-passed">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold text-green-800">TC103: ChatGPTスタイルUI テスト</h3>
                            <p class="text-sm text-green-600 mt-1">会話管理システムの動作確認</p>
                        </div>
                        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">✅ PASSED</span>
                    </div>
                    <div class="mt-3 text-sm text-gray-600">
                        <p><strong>手順:</strong> 新しいチャット作成・会話切り替え</p>
                        <p><strong>期待値:</strong> 複数会話が独立して管理される</p>
                        <p><strong>結果:</strong> ✅ 会話管理システム正常動作</p>
                    </div>
                </div>

                <div class="test-case p-4 border-l-4 rounded-lg status-passed">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold text-green-800">TC104: フィードバックシステムテスト</h3>
                            <p class="text-sm text-green-600 mt-1">検索結果評価・GitHub連携</p>
                        </div>
                        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">✅ PASSED</span>
                    </div>
                    <div class="mt-3 text-sm text-gray-660">
                        <p><strong>手順:</strong> フィードバック送信・管理画面確認</p>
                        <p><strong>期待値:</strong> フィードバックが記録され、GitHub Issue作成</p>
                        <p><strong>結果:</strong> ✅ フィードバック収集システム動作確認</p>
                    </div>
                </div>

                <div class="test-case p-4 border-l-4 rounded-lg status-pending">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold text-yellow-800">TC105: パフォーマンステスト</h3>
                            <p class="text-sm text-yellow-600 mt-1">大量データでの応答速度測定</p>
                        </div>
                        <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium">⏳ PENDING</span>
                    </div>
                    <div class="mt-3 text-sm text-gray-600">
                        <p><strong>手順:</strong> 1000件以上のデータでKnowledge Base検索</p>
                        <p><strong>期待値:</strong> 5秒以内に検索結果表示</p>
                        <p><strong>結果:</strong> ⏳ 大容量データ準備中</p>
                    </div>
                </div>

                <div class="test-case p-4 border-l-4 rounded-lg status-pending">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold text-yellow-800">TC106: セキュリティテスト</h3>
                            <p class="text-sm text-yellow-600 mt-1">APIキー漏洩・XSS脆弱性確認</p>
                        </div>
                        <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium">⏳ PENDING</span>
                    </div>
                    <div class="mt-3 text-sm text-gray-600">
                        <p><strong>手順:</strong> セキュリティスキャンツール実行</p>
                        <p><strong>期待値:</strong> 重大な脆弱性が検出されない</p>
                        <p><strong>結果:</strong> ⏳ セキュリティ監査計画中</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 新機能テストケース (動的生成) -->
        <div id="dynamic-test-cases">
            <!-- 機能設計書から自動生成されるテストケース -->
        </div>

        <!-- テスト環境情報 -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">テスト環境情報</h2>
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-3">テスト環境</h3>
                    <ul class="space-y-2 text-sm text-gray-600">
                        <li><strong>プラットフォーム:</strong> GitHub Pages</li>
                        <li><strong>ブラウザ:</strong> Chrome 120+, Firefox 121+, Safari 17+</li>
                        <li><strong>デバイス:</strong> Desktop, Mobile (iOS/Android)</li>
                        <li><strong>AI API:</strong> Dify + Google Gemini Flash</li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-3">テストデータ</h3>
                    <ul class="space-y-2 text-sm text-gray-600">
                        <li><strong>顧客データ:</strong> customer-info.csv (10件)</li>
                        <li><strong>商品カタログ:</strong> product-catalog.md</li>
                        <li><strong>競合分析:</strong> competitive-analysis.md</li>
                        <li><strong>Knowledge Base:</strong> frontoffice-data</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // テスト結果を動的に更新
        function updateTestSummary() {
            const testCases = document.querySelectorAll('.test-case');
            let passed = 0, failed = 0, pending = 0;
            
            testCases.forEach(testCase => {
                if (testCase.classList.contains('status-passed')) passed++;
                else if (testCase.classList.contains('status-failed')) failed++;
                else if (testCase.classList.contains('status-pending')) pending++;
            });
            
            document.getElementById('passed-count').textContent = passed;
            document.getElementById('failed-count').textContent = failed;
            document.getElementById('pending-count').textContent = pending;
            
            const total = passed + failed + pending;
            const coverage = total > 0 ? Math.round((passed / total) * 100) : 0;
            document.getElementById('coverage').textContent = coverage + '%';
        }

        // ページ読み込み時に実行
        document.addEventListener('DOMContentLoaded', () => {
            updateTestSummary();
            
            // Progress sync systemからフェーズ情報を取得
            setTimeout(() => {
                if (window.progressSync && window.progressSync.progressData) {
                    const currentPhase = window.progressSync.getCurrentPhase();
                    if (currentPhase) {
                        document.getElementById('test-phase-badge').textContent = currentPhase.name;
                    }
                }
            }, 100);
        });
    </script>
</body>
</html>